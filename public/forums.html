<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BlueSentinel | Community Forums</title>
    <link rel="stylesheet" href="css/global.css">
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <script src="js/core/firebase-init.js" defer></script>
    <script src="js/theme-toggle.js" defer></script>
    <script src="js/theme-toggle.js" defer></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <style>
        .forum-thread {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .forum-thread:hover {
            background: rgba(255, 255, 255, 0.06);
            border-color: var(--color-cyan);
            transform: translateY(-2px);
        }

        .thread-meta {
            color: var(--text-muted);
            font-size: 0.8rem;
            display: flex;
            gap: 1rem;
            margin-bottom: 0.5rem;
        }

        .report-form-container {
            border: 1px solid var(--color-cyan);
            background: rgba(0, 240, 255, 0.05);
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 3rem;
            display: none;
            /* Hidden by default */
        }

        .thread-tag {
            background: rgba(255, 255, 255, 0.1);
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.7rem;
            text-transform: uppercase;
        }
    </style>
    <script>
        function toggleReportForm() {
            const form = document.querySelector('.report-form-container');
            const btn = document.getElementById('new-report-btn');
            if (form.style.display === 'none' || !form.style.display) {
                form.style.display = 'block';
                btn.innerHTML = 'Cancel Report';
                btn.style.background = 'var(--color-void)';
                btn.style.border = '1px solid var(--color-danger)';
                btn.style.color = 'var(--color-danger)';
            } else {
                form.style.display = 'none';
                btn.innerHTML = '+ New Field Report';
                btn.style.background = 'var(--color-primary)';
                btn.style.border = 'none';
                btn.style.color = '#000';
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            const form = document.getElementById('manual-entry-form');
            if (form) {
                form.addEventListener('submit', (e) => {
                    e.preventDefault();
                    // Mock Submission
                    const btn = form.querySelector('button[type="submit"]');
                    const originalText = btn.innerHTML;

                    btn.innerHTML = '<span class="typing-dots">Submitting to Community...</span>';
                    btn.disabled = true;

                    setTimeout(() => {
                        alert("Report Submitted to Community Feed!");
                        btn.innerHTML = originalText;
                        btn.disabled = false;
                        form.reset();
                        toggleReportForm(); // Close form

                        // Ideally: prepend new thread to list
                    }, 1500);
                });
            }
        });
    </script>
</head>

<body>

    <div class="app-container">
        <!-- FLOATING NAVIGATION -->
        <nav class="floating-nav">
            <div class="nav-links">
                <a href="dashboard.html" class="nav-item">
                    <i class="bi bi-speedometer2 nav-icon"></i>
                    <span class="label">Monitor</span>
                </a>
                <a href="news.html" class="nav-item">
                    <i class="bi bi-newspaper nav-icon"></i>
                    <span class="label">News</span>
                </a>
                <a href="logs.html" class="nav-item">
                    <i class="bi bi-file-earmark-text nav-icon"></i>
                    <span class="label">Logs</span>
                </a>
                <a href="archive.html" class="nav-item">
                    <i class="bi bi-archive nav-icon"></i>
                    <span class="label">Archives</span>
                </a>
                <a href="forums.html" class="nav-item active">
                    <i class="bi bi-people nav-icon"></i>
                    <span class="label">Forums</span>
                </a>
            </div>
        </nav>

        <!-- MAIN CONTENT AREA -->
        <main class="main-content">

            <div class="page-center" style="max-width: 900px;">
                <!-- Header -->
                <header class="dashboard-header"
                    style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                    <a href="dashboard.html" style="text-decoration: none; display: block;">
                        <h1 class="text-gradient" style="font-size: 2rem;">Community Forums</h1>
                        <p style="color: var(--text-muted);">Collaborate with researchers and report local observations
                        </p>
                    </a>
                    <div style="display: flex; gap: 1rem;">
                        <button id="theme-toggle" class="btn-icon">
                            <i class="bi bi-sun-fill"></i>
                        </button>
                        <button id="new-report-btn" class="btn-primary" onclick="toggleReportForm()">
                            + New Field Report
                        </button>
                    </div>
                </header>

                <!-- Hidden Report Form -->
                <div class="report-form-container">
                    <h3 style="margin-bottom: 1.5rem; color: var(--color-cyan);">Submit Field Observation</h3>
                    <form id="manual-entry-form" style="display: flex; flex-direction: column; gap: 2rem;">
                        <!-- Simplified inputs for quick reporting -->
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem;">
                            <!-- Temp -->
                            <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                                <label style="color: var(--text-secondary); font-size: 0.9rem;">Temperature (°C)</label>
                                <input type="number" step="0.1" placeholder="e.g. 24.5" required
                                    style="background: rgba(255, 77, 77, 0.05); border: 1px solid rgba(255, 77, 77, 0.3); padding: 0.8rem; border-radius: 8px; color: white; outline: none;">
                            </div>
                            <!-- pH -->
                            <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                                <label style="color: var(--text-secondary); font-size: 0.9rem;">pH Level</label>
                                <input type="number" step="0.1" placeholder="e.g. 7.2" required
                                    style="background: rgba(0, 240, 255, 0.05); border: 1px solid rgba(0, 240, 255, 0.3); padding: 0.8rem; border-radius: 8px; color: white; outline: none;">
                            </div>
                        </div>
                        <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                            <label style="color: var(--text-secondary); font-size: 0.9rem;">Notes</label>
                            <textarea rows="3" placeholder="Describe water conditions..."
                                style="width: 100%; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); padding: 0.8rem; border-radius: 8px; color: white; outline: none; resize: vertical;"></textarea>
                        </div>
                        <button type="submit" class="btn-primary" style="justify-content: center;">Submit to
                            Community</button>
                    </form>
                </div>

                <!-- Discussions List -->
                <div class="forums-list">

                    <!-- Pinned Thread -->
                    <div class="forum-thread" style="border-left: 3px solid var(--color-warning);">
                        <div class="thread-meta">
                            <span class="thread-tag"
                                style="background: rgba(255, 214, 0, 0.2); color: var(--color-warning);">Announcement</span>
                            <span>• Admin • 2 hours ago</span>
                        </div>
                        <h3 style="color: white; margin-bottom: 0.5rem;">System Update: Deployment of Node-Beta-2</h3>
                        <p style="color: var(--text-secondary); font-size: 0.95rem;">
                            We have successfully deployed the new sensor array near the delta. Community members should
                            expect to see new data streams coming online within the next 24 hours. Please report any
                            anomalies here.
                        </p>
                    </div>

                    <!-- Thread 1 -->
                    <div class="forum-thread">
                        <div class="thread-meta">
                            <span class="thread-tag">Field Report</span>
                            <span>• Dr. Sarah Chen • 5 hours ago</span>
                        </div>
                        <h3 style="color: white; margin-bottom: 0.5rem;">Unusual Algal Bloom near Sector 4</h3>
                        <p style="color: var(--text-secondary); font-size: 0.95rem;">
                            Visual observation confirms increased turbidity and greenish tint. Correlates with the
                            recent temperature spike. Suggest increasing sampling frequency in this sector.
                        </p>
                    </div>

                    <!-- Thread 2 -->
                    <div class="forum-thread">
                        <div class="thread-meta">
                            <span class="thread-tag">Question</span>
                            <span>• Student_LabGroup • 1 day ago</span>
                        </div>
                        <h3 style="color: white; margin-bottom: 0.5rem;">Interpreting pH fluctuations during rainfall
                        </h3>
                        <p style="color: var(--text-secondary); font-size: 0.95rem;">
                            Does the system automatically account for acid rain runoff in the predictive model? We are
                            seeing a dip to 6.8 after last night's storm.
                        </p>
                    </div>

                </div>

            </div>

        </main>
    </div>

</body>

</html>